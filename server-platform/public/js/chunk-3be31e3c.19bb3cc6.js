(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3be31e3c"],{"0a0c":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("DialogComp",{attrs:{title:"添加到收藏夹"},on:{maskClick:function(t){return e.$emit("maskClick")}},nativeOn:{click:function(t){return e.handleDialogClick.apply(null,arguments)}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{staticClass:"confirm-btn",attrs:{loading:e.confirmLoading},on:{click:e.confirm}},[e._v("确定")])]},proxy:!0}])},[[e._l(e.favoriteItem,(function(t){return n("FavoriteItem",{key:t.id,attrs:{select:e.activeIndex.includes(t.id),item:t},nativeOn:{click:function(n){return e.handleClick(t,t.id)}}})})),n("div",{ref:"addGroup",staticClass:"add-group",class:{hide:e.showFormInput},on:{click:function(t){e.showFormInput=!0}}},[n("div",{ref:"addGroupBtn",staticClass:"add-btn"},[e._v("新建收藏夹")])]),n("form",{ref:"inputGroup",staticClass:"input-group",class:{show:e.showFormInput}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newFavorite,expression:"newFavorite"}],ref:"input",attrs:{type:"text",maxlength:"20",placeholder:"最多可输入20个字"},domProps:{value:e.newFavorite},on:{input:function(t){t.target.composing||(e.newFavorite=t.target.value)}}}),n("button",{ref:"submitBtn",staticClass:"submit",on:{click:function(t){return t.preventDefault(),e.addNewFavorite.apply(null,arguments)}}},[e._v(" 新建 ")])])]],2)},i=[],o=n("1da1"),s=(n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"favorite-item-wrapper"},[n("span",{class:{selected:e.select}}),n("p",[e._v(e._s(e.item.name))])])}),r=[],c={props:{item:Object,select:Boolean}},u=c,l=(n("2a6a"),n("2877")),d=Object(l["a"])(u,s,r,!1,null,"39cc24b2",null),g=d.exports,p=n("0874"),m={components:{FavoriteItem:g,DialogComp:p["a"]},props:{confirmLoading:Boolean,favoriteItem:{type:Array,default:function(){return[]}},activeIndex:Array},data:function(){return{showFormInput:!1,newFavorite:""}},methods:{confirm:function(){this.$emit("confirm")},handleClick:function(e,t){this.$emit("select",e,t)},addNewFavorite:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(""==e.newFavorite||e.newFavorite.length>=20)){t.next=3;break}return e.$message({message:"收藏夹的名字好像不规范",duration:1500,type:"warning"}),t.abrupt("return");case 3:return t.next=5,e.$api.addFavorite({name:e.newFavorite});case 5:n=t.sent,e.$emit("addFavorite",n.data,n.data.id),e.showFormInput=!1,e.newFavorite="";case 9:case"end":return t.stop()}}),t)})))()},handleDialogClick:function(e){e.target!==this.$refs.addGroup&&e.target!==this.$refs.addGroupBtn?e.target!==this.$refs.submitBtn&&e.target!==this.$refs.inputGroup&&e.target!==this.$refs.input&&(this.showFormInput=!1):this.showFormInput=!0}}},f=m,h=(n("9bd2"),Object(l["a"])(f,a,i,!1,null,"065b06be",null));t["a"]=h.exports},"0ee3":function(e,t,n){"use strict";n("7052")},"26da":function(e,t,n){},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("6b75");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return i(e)||o(e)||Object(s["a"])(e)||r()}},"2a6a":function(e,t,n){"use strict";n("26da")},3167:function(e,t,n){"use strict";n.r(t);var a,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"manage-song-wrapper"},[n("div",{staticClass:"header-search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"header-search-input",attrs:{placeholder:"请输入搜索关键字，默认搜索全部"},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(!1)},input:function(t){t.target.composing||(e.value=t.target.value)}}}),n("button",{staticClass:"search-button",on:{click:function(t){return e.handleSearch(!1)}}}),n("h2",{staticClass:"my-song p-a"},[e._v("我的歌曲")]),n("div",{staticClass:"option-wrapper p-a"},e._l(e.optionItems,(function(t,a){return n("span",{key:t.title,staticClass:"header-option-item p-r",class:{active:t.active},on:{click:function(n){return e.handleChangeOption(t,a)}}},[e._v(e._s(t.title))])})),0)]),n("ul",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-list-container"},[e._m(0),0===e.songList.length?n("NoDataComp",{attrs:{title:"啊嘞嘞，好像没有歌曲哦"}}):e._e(),e._l(e.songList,(function(t,a){return n("li",{key:t.id,staticClass:"search-item p-r"},[n("span",{staticStyle:{padding:"0 10px","box-sizing":"border-box"},attrs:{title:e._f("formatSongName")(t.originName)}},[e._v(e._s(e._f("formatSongName")(t.originName)))]),n("span",[e._v(e._s(e._f("formatDate")(t.createdAt)))]),n("span",{attrs:{title:"创作歌曲为自己翻唱或原创或经过作者同意上传的，可以共享到平台供他人试听，他人歌曲及有版权歌曲可以加入歌单，不共享到平台上"}},[e._v(e._s(t.creative?"创作歌曲":"他人歌曲"))]),n("span",{staticClass:"manage-button-wrapper"},[n("span",{staticClass:"btn-wrapper"},[n("span",{staticClass:"header-btn play-btn",attrs:{title:"播放歌曲"},on:{click:function(t){return e.playSong(e.songList,a)}}}),n("span",{staticClass:"header-btn star-btn",attrs:{title:"收藏歌曲"},on:{click:function(n){return e.collectSong(t.id)}}}),n("span",{staticClass:"header-btn share-btn",attrs:{title:"分享歌曲"}})]),n("span",[n("span",{staticClass:"setting-button music-iconfont icon-shezhi3",on:{click:function(n){return e.showEditComp(t)}}}),n("span",{staticClass:"delete el-icon-delete",on:{click:function(n){e.deleteInfo.deleteItem=t,e.deleteInfo.showMessage=!0}}})])])])}))],2),n("PagerComp",{attrs:{handleCurrentChange:e.handleCurrentChange,page:e.page,size:e.size,count:e.count}}),n("AddFavoriteComp",{directives:[{name:"show",rawName:"v-show",value:e.showMask,expression:"showMask"}],attrs:{confirmLoading:e.confirmLoading,favoriteItem:e.favoriteContext,activeIndex:e.activeIndex},on:{addFavorite:e.addFavorite,select:e.select,maskClick:function(t){e.showMask=!1},confirm:e.favoriteConfirm}}),e.editingSong?n("MyTeleport",[e.showEditSongComp?n("EditSong",{attrs:{confirmLoading:e.changeSongNameLoading,songItem:e.editingSong},on:{confirm:e.changeSongName,changeSongToUnCreative:e.changeSongToUnCreative,applySongToCreative:e.applySongToCreative,maskClick:function(t){e.showEditSongComp=!1}}}):e._e()],1):e._e(),n("DeleteTip",{attrs:{showMessage:e.deleteInfo.showMessage,deleteTip:"即将删除歌曲",confirmLoading:e.deleteInfo.deleteLoading},on:{handleConfirmDelete:e.deleteSong,maskHide:function(t){e.deleteInfo.showMessage=!1}}})],1)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"search-item header"},[n("span",[e._v("歌曲名")]),n("span",[e._v("上传时间")]),n("span",[e._v("歌曲性质")]),n("span",[e._v("歌曲管理")])])}],s=n("2909"),r=n("1da1"),c=(n("d81d"),n("a434"),n("159b"),n("96cf"),n("eb4d")),u=n("03fb"),l=n("6ab7"),d=n("7105"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("DialogComp",{attrs:{title:"编辑歌曲信息"},on:{maskClick:function(t){return e.$emit("maskClick")}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{staticClass:"confirm-btn",attrs:{loading:e.confirmLoading},on:{click:e.confirm}},[e._v("提交新歌名")])]},proxy:!0}])},[[n("el-form",{staticClass:"form-wrapper",attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"歌名:"}},[n("el-input",{attrs:{placeholder:"请输入歌曲名"},model:{value:e.formData.songName,callback:function(t){e.$set(e.formData,"songName",t)},expression:"formData.songName"}})],1),n("p",{staticClass:"group"},[n("span",{staticClass:"label"},[e._v("时长：")]),n("span",{staticClass:"value"},[e._v(e._s(e._f("formatTime")(e.songItem.duration)))])]),n("p",{staticClass:"group"},[n("span",{staticClass:"label"},[e._v("播放量：")]),n("span",{staticClass:"value"},[e._v(e._s(e.songItem.broadcast))])]),n("p",{staticClass:"group"},[n("span",{staticClass:"label"},[e._v("歌词：")]),n("span",{staticClass:"value"},[e._v(e._s(e.songItem.lyric?"已有歌词":"没有歌词"))]),n("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.toLyric}},[e._v("管理歌词")])],1),n("p",{staticClass:"group"},[n("span",{staticClass:"label"},[e._v("性质：")]),n("span",{staticClass:"value"},[e._v(e._s(e.isCreative?"创作歌曲":"他人歌曲"))]),e.isCreative?n("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){e.showMessageTip=!0}}},[e._v("转为个人歌曲")]):e._e(),e.isCreative?e._e():n("el-button",{staticClass:"btn success",attrs:{type:"primary"},on:{click:function(t){return e.$emit("applySongToCreative",e.songItem.id,e.userDesc)}}},[e._v("申请为创作歌曲")])],1),n("el-input",{staticClass:"text-area",attrs:{type:"text-area",placeholder:"如果你要申请为创作歌曲，可以在这里添加说明更容易通过审核"},model:{value:e.userDesc,callback:function(t){e.userDesc=t},expression:"userDesc"}})],1)],n("ImportantTipComp",{attrs:{showMessage:e.showMessageTip,confirmLoading:e.changeLoading,importantTip:"歌曲将转为非创作歌曲"},on:{handleConfirm:e.handleConfirmChange,maskHide:function(t){e.showMessageTip=!1}}})],2)},p=[],m=n("0874"),f=n("cadb"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("MessageTipComp",{directives:[{name:"show",rawName:"v-show",value:e.showMessage,expression:"showMessage"}],staticStyle:{cursor:"default"},attrs:{title:e.title},on:{maskClick:function(t){return e.$emit("maskHide")}},scopedSlots:e._u([{key:"default",fn:function(){return[n("div",{staticClass:"message-tip",staticStyle:{"line-height":"normal"}},[e._v(" "+e._s(e.importantTip)+" ")])]},proxy:!0},{key:"footer",fn:function(){return[n("div",{staticClass:"message-btn-wrapper"},[n("ConfirmBtn",{attrs:{loading:e.confirmLoading},on:{click:function(t){return e.$emit("handleConfirm")}}}),n("CancelBtn",{on:{click:function(t){return e.$emit("maskHide")}}})],1)]},proxy:!0}])})},v=[],C=n("0d45"),w=n("0d1d"),b=n("a13d"),k={components:{MessageTipComp:C["a"],ConfirmBtn:w["a"],CancelBtn:b["a"]},props:{showMessage:Boolean,importantTip:String,confirmLoading:Boolean,title:{type:String,default:"重要操作提示"}}},y=k,S=(n("824a"),n("2877")),x=Object(S["a"])(y,h,v,!1,null,"d3df843a",null),_=x.exports,I={components:{DialogComp:m["a"],ImportantTipComp:_},props:{confirmLoading:Boolean,songItem:Object},data:function(){return{formData:{songName:""},userDesc:"",isCreative:!1,showMessageTip:!1,changeLoading:!1}},filters:{formatTime:f["b"]},created:function(){this.formData.songName=this.songItem.originName,this.isCreative=1==this.songItem.creative&&2==this.songItem.status},methods:{toLyric:function(){var e=this;this.$emit("maskClick"),setTimeout((function(){e.$router.push("/addLyric/"+e.songItem.id)}),0)},confirm:function(){this.formData.songName!==this.songItem.originName?this.$emit("confirm",this.formData.songName):this.$message({message:"歌名好像没有改变哦",duration:1500})},handleConfirmChange:function(){var e=this;this.changeLoading=!0,this.$emit("changeSongToUnCreative",(function(){e.changeLoading=!1,e.showMessageTip=!1}))}}},$=I,L=(n("0ee3"),Object(S["a"])($,g,p,!1,null,"75d72045",null)),F=L.exports,D=n("0a0c"),N=n("43a0"),T=n("bb70"),M=0,O=[],j=[],E={components:{NoDataComp:l["a"],AddFavoriteComp:D["a"],PagerComp:N["a"],EditSong:F,MyTeleport:d["a"],DeleteTip:T["a"]},data:function(){return{songList:[],count:0,size:8,page:1,keyword:"",value:"",loading:!1,confirmLoading:!1,optionItems:[{title:"最近上传",active:!0},{title:"播放量最高",active:!1},{title:"只看创作歌曲",active:!1}],option:0,showMask:!1,favoriteContext:[],activeIndex:[],showEditSongComp:!1,editingSong:null,changeSongNameLoading:!1,deleteInfo:{showMessage:!1,deleteLoading:!1,deleteItem:null}}},filters:{formatSongName:c["c"],formatDate:c["b"]},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:document.title="我的歌曲",e.getSongWithPageConfig(),e.getFavoriteContext();case 3:case"end":return t.stop()}}),t)})))()},methods:{deleteSong:function(){var e=this;this.deleteInfo.deleteLoading=!0,this.$handleMessage(this.$api.deleteSong(this.deleteInfo.deleteItem),void 0,!0,"歌曲已经删除").then((function(t){e.deleteInfo.deleteLoading=e.deleteInfo.showMessage=!1,t&&e.getSongWithPageConfig()}))},applySongToCreative:function(e,t){var n=this;this.$handleMessage(this.$api.applySongToCreative({id:e,userDesc:t}),void 0,!0,"已经提交申请，继续努力哟").then((function(e){n.showEditSongComp=!1,e&&n.getSongWithPageConfig()}))},changeSongToUnCreative:function(e){var t=this;this.$handleMessage(this.$api.changeSongToUnCreative({id:this.editingSong.id}),void 0,!0,"歌曲已经为非创作歌曲，不在平台共享,继续创作哟").then((function(n){"function"===typeof e&&e(),t.showEditSongComp=!1,console.log(e),n&&t.getSongWithPageConfig()}))},getSongWithPageConfig:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,o,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getDataWithPageConfig();case 2:n=t.sent,a=n.code,i=n.msg,o=n.data,200===a?(s=o.count,r=o.data,e.count=s,e.songList=r):e.$message({type:"error",message:i,duration:1500});case 7:case"end":return t.stop()}}),t)})))()},showEditComp:function(e){this.editingSong=e,this.showEditSongComp=!0},changeSongName:function(e){var t=this;this.changeSongNameLoading=!0,this.$handleMessage(this.$api.changeSongName({id:this.editingSong.id,newSongName:e}),void 0,!0,"歌名修改成功").then((function(e){t.changeSongNameLoading=!1,t.showEditSongComp=!1,e?t.getSongWithPageConfig():t.showEditSongComp=!1}))},addFavorite:function(e,t){this.activeIndex.push(t),this.favoriteContext.push(e),O.push(e)},collectSong:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showMask=!0,n.next=3,t.$api.getSongStatusInFavorite({songId:e});case 3:i=n.sent,a=e,200===i.code&&(t.activeIndex=i.data.map((function(e){return e.FavoriteId})),j=Object(s["a"])(t.activeIndex));case 6:case"end":return n.stop()}}),n)})))()},select:function(e,t){var n=this.activeIndex.indexOf(t);n>=0?(this.activeIndex.splice(n,1),O.splice(n,1)):(this.activeIndex.push(t),O.push(e))},getFavoriteContext:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getUserAllFavoriteContext();case 2:n=t.sent,200===n.code&&(e.favoriteContext=n.data);case 4:case"end":return t.stop()}}),t)})))()},getDataWithPageConfig:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$api.getSongWithPage({page:e.page,size:e.size,keyword:e.keyword,option:e.option});case 3:return n=t.sent,e.loading=!1,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))()},playSong:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0!==e.length?(this.$store.commit("Song/setSongList",e),this.$store.commit("Song/setPlayingIndex",n),this.$message({message:"即将播放歌曲",type:"success",duration:1500,onClose:function(){t.$router.push({path:"/song/any"})}})):this.$message({message:"好像没有歌曲哦",type:"warning",duration:1500})},favoriteConfirm:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.confirmLoading=!0,n=Object(u["a"])(j,e.activeIndex),t.next=4,e.$api.confirmFavorite({config:n,songId:a});case 4:i=t.sent,200===i.code&&(j=Object(s["a"])(e.activeIndex)),e.confirmLoading=!1,e.$message({message:"添加收藏夹成功",duration:1500,type:"success"});case 8:case"end":return t.stop()}}),t)})))()},handleChangeOption:function(e,t){t!==M&&(this.optionItems.forEach((function(e){return e.active=!1})),e.active=!0,this.option=t,M=t,this.handleSearch(!0))},handleSearch:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,o,s,r,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.keyword!=t.value||e){n.next=2;break}return n.abrupt("return");case 2:return t.page=1,e||(t.keyword=t.value),console.log(e,t.keyword),n.next=7,t.getDataWithPageConfig();case 7:a=n.sent,i=a.code,o=a.msg,s=a.data,200===i?(r=s.count,c=s.data,t.count=r,t.songList=c):t.$message({type:"error",message:o,duration:1500});case 12:case"end":return n.stop()}}),n)})))()},handleCurrentChange:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a,i,o,s,r,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.page=e,n.next=3,t.getDataWithPageConfig();case 3:a=n.sent,i=a.code,o=a.msg,s=a.data,200===i?(r=s.count,c=s.data,t.count=r,t.songList=c):t.$message({type:"error",message:o,duration:1500});case 8:case"end":return n.stop()}}),n)})))()}}},R=E,P=(n("d441"),Object(S["a"])(R,i,o,!1,null,"6c20683b",null));t["default"]=P.exports},7052:function(e,t,n){},"741a":function(e,t,n){},"824a":function(e,t,n){"use strict";n("bd75")},"84f2":function(e,t,n){},"9bd2":function(e,t,n){"use strict";n("741a")},bd75:function(e,t,n){},d441:function(e,t,n){"use strict";n("84f2")}}]);
//# sourceMappingURL=chunk-3be31e3c.19bb3cc6.js.map